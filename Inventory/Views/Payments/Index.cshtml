
@using Inventory.Models
@model Inventory.Models.Payments
@{
    ViewBag.Title = "Payments";
    Layout = "~/Views/Shared/MainMaster.cshtml";
}
@section css{
    <!-- Bootstrap -->
    <link href="../vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="../vendors/iCheck/skins/flat/green.css" rel="stylesheet">
    <!-- bootstrap-progressbar -->
    <link href="../vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
    <!-- JQVMap -->
    <link href="../vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet" />
    <!-- bootstrap-daterangepicker -->
    <link href="../vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">

    <!-- Custom Theme Style -->
    <link href="../build/css/custom.min.css" rel="stylesheet">
    @*Over Hang*@
    <link href="~/Scripts/css/overhang.min.css" rel="stylesheet" />
    <!--- Tabs in Graph Section ---->
    <link href="~/Scripts/css/reset.css" rel="stylesheet" />
    <link href="~/Scripts/css/dashboardstyles.css" rel="stylesheet" />

}
<div class="container body">
    <div class="main_container">
        <!-- top navigation -->
        <!-- page content -->
        <div class="right_col" role="main">
            <div class="container">
                <form>
                    <div class="row total-border">
                        <div class="col-xs-12 col-md-12">
                            <div class="row">
                                <div class="col-xs-12 col-md-12">
                                    <div class="row">
                                        <div class="form-title col-xs-12 col-md-12">Receive Payments</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-bottom">
                                @{ Html.RenderAction("CustomerforPOs", "Products");}

                                <div class="col-xs-12 col-md-3 margin-bottom">
                                    <div class="row padding-bottom date" id="paymentsddate">
                                        Date :
                                        <script> document.write(new Date().toLocaleDateString('en-GB'));</script>
                                    </div>
                                    <div class="row invoice-total-amount" id="invoicedtotal"> <text class="localization"></text> <span>@ViewBag.total_price</span> </div>
                                </div>
                            </div>

                            <div class="row po-date"></div>
                            <div class="row padding-top invoice">
                                <div class="row invoice-table margin-top margin-bottom">
                                    <div class="col-md-12">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th class="col-md-1">Select</th>
                                                    <th class="col-md-2">Invoice No</th>
                                                    <th class="col-md-3">Payment Due Date</th>
                                                    <th class="col-md-2">Total Item</th>
                                                    <th class="col-md-2">Amount In <text class="localization"></text></th>
                                                    <th class="col-md-3">Open Amount In <text class="localization"></text></th>
                                                </tr>
                                            </thead>

                                            @if (ViewBag.records != null)
                                            {
                                                foreach (var item in ViewBag.records)
                                                {
                                                    <tbody>
                                                        @if (item.open_amount == "0")
                                                        {
                                                            <tr style="display:none">
                                                            </tr>
                                                        }else
                                                        {
                                                        <tr>
                                                            <td class="col-md-1">
                                                                <label><input type="checkbox" value="@item.open_amount,@item.Prchaseorder_no" onclick="addtotal()"></label>
                                                            </td>
                                                            <td class="col-md-2">@item.Invoice_no</td>
                                                            <td class="col-md-3">@item.Payment_date</td>
                                                            <td class="col-md-2">@item.totalQty</td>
                                                            <td class="col-md-2"><span>@item.total_price</span></td>
                                                            @if (item.open_amount == null || item.open_amount == "")
                                                            {
                                                                <td class="col-md-3"><span>@item.total_price</span></td>
                                                            }
                                                            else
                                                            {
                                                            <td class="col-md-3"><span>@item.open_amount</span></td>
                                                            }
                                                        </tr>
                                                        }
                                                    </tbody>
                                                }

                                            }
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="row payment-method margin-top">
                                <h2 class="col-xs-12 col-sm-12 col-md-12">Payments</h2>
                                <div class="col-xs-12 col-sm-8 col-md-8">
                                    <div class="payment-option">
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optradio" id="radio-cheque" onchange="enableText(this)">
                                                Cheque
                                            </label>
                                        </div>
                                        <div class="row margin-top" id="cheque-details">
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group" style="margin-bottom:0;">
                                                    <label>Date</label>
                                                </div>
                                                <div class="input-group">
                                                    <div class="input-group-addon"> <i class="fa fa-calendar"> </i> </div>
                                                    <input class="form-control" id="chequedate" name="date" placeholder="DD/MM/YYYY" type="text">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Bank name</label>
                                                    <input type="text" class="form-control" id="bankname">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Cheque No</label>
                                                    <input type="text" class="form-control" id="chequeno">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="payment-option">
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optradio" id="radio-credit" onchange="enableText(this)">
                                                Credit / Debit Card
                                            </label>
                                        </div>
                                        <div class="row margin-top" id="credit-details">
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group" style="margin-bottom:0;">
                                                    <label>Date</label>
                                                </div>
                                                <div class="input-group">
                                                    <div class="input-group-addon"> <i class="fa fa-calendar"> </i> </div>
                                                    <input class="form-control" id="creditdate" name="date" placeholder="DD/MM/YYYY" type="text">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Card Holder name</label>
                                                    <input type="text" class="form-control" id="creditcardholdername">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Last 4 digits </label>
                                                    <input type="text" class="form-control" id="creditcardlast4digits">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="payment-option">
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optradio" id="radio-banktransfer" onchange="enableText(this)">
                                                Bank Transfer
                                            </label>
                                        </div>
                                        <div class="row margin-top" id="baltransfer-details">
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group" style="margin-bottom:0;">
                                                    <label>Date</label>
                                                </div>
                                                <div class="input-group">
                                                    <div class="input-group-addon"> <i class="fa fa-calendar"> </i> </div>
                                                    <input class="form-control" id="banktransferdate" name="date" placeholder="DD/MM/YYYY" type="text">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Name</label>
                                                    <input type="text" class="form-control" id="banknametrans">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Transaction Id </label>
                                                    <input type="text" class="form-control" id="transactionid">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>IFSC Code </label>
                                                    <input type="text" class="form-control" id="ifsccode">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Branch Name </label>
                                                    <input type="text" class="form-control" id="branchname">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="payment-option">
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optradio" id="radio-cash" onchange="enableText(this)">
                                                Cash
                                            </label>
                                        </div>
                                        <div class="row margin-top" id="cash-details">
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group" style="margin-bottom:0;">
                                                    <label>Date</label>
                                                </div>
                                                <div class="input-group">
                                                    <div class="input-group-addon"> <i class="fa fa-calendar"> </i> </div>
                                                    <input class="form-control" id="cashdate" name="date" placeholder="DD/MM/YYYY" type="text">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Cashier Name</label>
                                                    <input type="text" class="form-control" id="holdername">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="payment-option">
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="optradio" id="radio-wallet" onchange="enableText(this)">
                                                Wallet
                                            </label>
                                        </div>
                                        <div class="row margin-top" id="wallet-details">
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group" style="margin-bottom:0;">
                                                    <label>Date</label>
                                                </div>
                                                <div class="input-group">
                                                    <div class="input-group-addon"> <i class="fa fa-calendar"> </i> </div>
                                                    <input class="form-control" id="walletdate" name="date" placeholder="DD/MM/YYYY" type="text">
                                                </div>
                                            </div>
                                            <div class="col-xs-12 col-sm-4 col-md-4">
                                                <div class="form-group">
                                                    <label>Mobile Number</label>
                                                    <input type="text" class="form-control" id="mobilenumber">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4 payment-right">

                                    <div class="row">
                                        <div class="col-xs-12 col-sm-5 col-md-5"> Invoiced Amount </div>
                                        <div class="col-xs-12 col-sm-7 col-md-7">
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="invoicedamt">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-xs-12 col-sm-5 col-md-5"> Received Amount </div>
                                        <div class="col-xs-12 col-sm-7 col-md-7">
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="paidamt" onkeyup="calculateamnt()">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-5 col-md-5"> Opening Balance </div>
                                        <div class="col-xs-12 col-sm-7 col-md-7">
                                            <div class="form-group">
                                                <input type="text" class="form-control pre-balance" id="previousamt">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-5 col-md-5"> Current Balance </div>
                                        <div class="col-xs-12 col-sm-7 col-md-7">
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="currntamt">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row add-condition-block">
                                <div class="add-conditions">
                                    <div class="form-group">
                                        <input type="text" class="form-control" id="terms-input">
                                    </div>
                                    <button type="button" class="btn btn-default" id="add-condition">Save</button>
                                    <button type="button" class="btn btn-default" id="cancle-condition">Cancle</button>
                                </div>
                            </div>
                            <div class="row margin-top">
                                <div class="col-xs-12 col-md-6 margin-top margin-bottom" id="invoice-conditions">
                                    <a href="#" class="condition">
                                        <i class="fa fa-plus-circle" aria-hidden="true"></i>Terms and Conditions
                                    </a>
                                    <ul class="terms-content margin-top">
                                        <li>1) Lorem Ipsum is simply dummy text of the printing and typesetting industry</li>
                                        <li>2) Text has been the industry's standard dummy text ever since</li>
                                        <li>3) Enter here is simply dummy text of the printing and typesetting industry</li>
                                        <li>4) Here we have industry's standard dummy text ever since</li>
                                        <li>5) Dummy content is simply dummy text of the printing and typesetting industry</li>
                                        <li>6) Enter content has been the industry's standard dummy text ever since</li>
                                    </ul>
                                </div>
                                <div class="col-xs-12 col-md-6 remarks margin-top">
                                    <label>Remarks</label>
                                    <textarea class="form-control" rows="3" id="comment"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row margin-top">
                        <div class="col-xs-12 col-md-12 invoice-buttons">
                            <button type="button" class="btn btn-primary pull-right invite" id="back-payments"> <i class="fa fa-arrow-left" aria-hidden="true"></i> Back </button>
                            <button type="button" class="btn btn-primary pull-right invite" id="add-vendor"> <i class="fa fa-download" aria-hidden="true"></i> PDF </button>
                            <button type="button" class="btn btn-primary pull-right invite" id="add-vendor"> <i class="fa fa-paper-plane" aria-hidden="true"></i> E-Mail </button>
                            <button type="button" class="btn btn-primary pull-right save" id="save-payments" onclick="savepayments(@ViewBag.customer_id,'@ViewBag.company_name')"><i class="fa fa-floppy-o" aria-hidden="true"></i>Save</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- /page content -->
<!-- jQuery lib & Tabs -->
<script src="~/Scripts/js/jquery-3.1.1.min.js"></script>
<script src="~/Scripts/js/main.js"></script>
<script src="~/Scripts/js/modernizr.js"></script>
<!-- jQuery -->
<script src="../vendors/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="../vendors/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="../build/js/custom.min.js"></script>
<!-- Over Hang -->
<script src="~/Scripts/js/jquery-ui.min.js"></script>
<script src="~/Scripts/js/overhang.min.js"></script>

<!-------------- Date Picker lib ----------->
<script src="/Scripts/js/bootstrap-datepicker.min.js"></script>
<link href="/Scripts/css/bootstrap-datepicker3.css" rel="stylesheet" />

<!-------------- Date Picker lib ----------->
@Scripts.Render("~/bundles/Payments")
<script>
@*<!-------------- Date Picker ----------->*@
    $(document).ready(function () {
        var date_input = $('input[name="date"]'); //our date input has the name "date"
        var container = $('.bootstrap-iso form').length > 0 ? $('.bootstrap-iso form').parent() : "body";
        date_input.datepicker({
            format: 'mm/dd/yyyy',
            container: container,
            todayHighlight: true,
            autoclose: true,
        })
    });
    //<!-------------- Date Picker ----------->
    $('#back-payments').click(function () {
        document.location = '@Url.Action("Index", "Customer")';
    });


    //function calculateamount(paidamunt) {
    //    var previous = $("#previousamt").val();
    //    $("#currntamt").val(previous - paidamunt);
    //}
    //<!----------------- Payment Section------------->

    window.enableText = function (e) {

        var chequedetails = document.getElementById('cheque-details');
        var creditdetails = document.getElementById('credit-details');
        var baltransferdetails = document.getElementById('baltransfer-details');
        var cashdetails = document.getElementById("cash-details");
        var walletdetails = document.getElementById("wallet-details");

        if (e.id == 'radio-cheque') {
            chequedetails.readOnly = false;
            chequedetails.style.display = "block";
        } else {
            chequedetails.readOnly = true;
            chequedetails.style.display = "none";
        }

        if (e.id == 'radio-credit') {
            creditdetails.readOnly = false;
            creditdetails.style.display = "block";
        } else {
            creditdetails.readOnly = true;
            creditdetails.style.display = "none";
        }

        if (e.id == 'radio-banktransfer') {
            baltransferdetails.readOnly = false;
            baltransferdetails.style.display = "block";
        } else {
            baltransferdetails.readOnly = true;
            baltransferdetails.style.display = "none";
        }

        if (e.id == 'radio-cash') {
            cashdetails.readOnly = false;
            cashdetails.style.display = "block";
        } else {
            cashdetails.readOnly = true;
            cashdetails.style.display = "none";
        }
        if (e.id == 'radio-wallet') {
            walletdetails.readOnly = false;
            walletdetails.style.display = "block";
        } else {
            walletdetails.readOnly = true;
            walletdetails.style.display = "none";
        }

    }

    //<!----------------- Payment Section------------->

    //<!-------------- Add custom Conditions ----------->

    $("#add-condition").click(function () {
        var txt = $("#terms-input").val();
        var len = $("#invoice-conditions > ul > li").length;
        len += 1;
        $("#invoice-conditions > ul").append("<li><span>" + len + "</span>) " + txt + "</li>");
        $(".add-condition-block").css("display", "none");
    });
    $("#cancle-condition").click(function () {
        $(".add-condition-block").css("display", "none");
    });
    $(".condition").click(function () {
        $(".add-condition-block").css("display", "block");
        $("#terms-input").val("").focus();
    });

    //<!-------------- Add custom Conditions ----------->

    //<!-------------- balance block ----------->
    var invoicetotalamount = parseInt($(".invoice-total-amount > span").text());
    $("input[type='text'].pre-balance").val(invoicetotalamount);
    //<!-------------- balance block ----------->

</script>
